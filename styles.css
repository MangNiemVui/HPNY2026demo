/* styles.css — HPNY 2026 (Năm Ngọ) • Reskin Tết phương Đông + thêm mini game
   - Không thay data đăng nhập / lời chúc
   - Thêm countdown + flow: nhập ngân hàng -> vòng quay -> lắc quẻ
   - Animation bằng CSS/JS (không GIF)
*/

:root{
  --ink:#2b1500;
  --muted: rgba(43,21,0,.72);

  --bgDeep:#4b0014;
  --bgRed:#7a0014;
  --bgRed2:#b40018;
  --gold:#ffcc4d;
  --gold2:#ffe7a3;

  --card: rgba(255, 243, 222, .88);
  --card2: rgba(255, 243, 222, .78);
  --stroke: rgba(255, 220, 150, .38);
  --shadow: 0 22px 65px rgba(0,0,0,.35);

  --accent:#b40018;
  --accent2:#ffcc4d;
  --danger:#ff4d6d;
  --radius: 24px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  overflow:hidden;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: var(--ink);
  background:
    radial-gradient(1200px 800px at 15% 15%, rgba(255, 204, 77, .10), transparent 60%),
    radial-gradient(900px 700px at 80% 20%, rgba(255, 100, 120, .12), transparent 58%),
    radial-gradient(900px 700px at 60% 85%, rgba(255, 230, 163, .12), transparent 60%),
    linear-gradient(135deg, var(--bgDeep), var(--bgRed));
}

/* subtle pattern */
body::before{
  content:"";
  position:fixed; inset:0;
  background:
    repeating-linear-gradient(45deg, rgba(255, 204, 77, .05) 0 2px, transparent 2px 14px),
    repeating-linear-gradient(-45deg, rgba(255, 255, 255, .03) 0 1px, transparent 1px 16px);
  opacity:.55;
  pointer-events:none;
  mix-blend-mode: overlay;
}

canvas#fx{
  position:fixed; inset:0; width:100vw; height:100vh;
  display:block; pointer-events:none;
  z-index: 5;
}

.sparkles{
  position:fixed; inset:0;
  background:
    radial-gradient(1.5px 1.5px at 22% 30%, rgba(255,255,255,.75) 40%, transparent 45%),
    radial-gradient(1.2px 1.2px at 62% 12%, rgba(255,255,255,.70) 40%, transparent 45%),
    radial-gradient(1.6px 1.6px at 82% 52%, rgba(255,255,255,.70) 40%, transparent 45%),
    radial-gradient(1.1px 1.1px at 35% 75%, rgba(255,255,255,.65) 40%, transparent 45%),
    radial-gradient(1.3px 1.3px at 12% 62%, rgba(255,255,255,.70) 40%, transparent 45%);
  opacity:.55;
  pointer-events:none;
  filter: blur(.15px);
  mix-blend-mode: soft-light;
  z-index: 6;
}

/* ===== Decorative: lanterns, clouds, petals ===== */
.lantern{
  position: fixed;
  top: -10px;
  width: 140px;
  z-index: 8;
  pointer-events:none;
  transform-origin: 50% 0%;
  animation: lanternSwing 3.5s ease-in-out infinite;
  filter: drop-shadow(0 10px 28px rgba(0,0,0,.35));
  opacity:.92;
}
.lantern img{ width:100%; height:auto; display:block; }
.lantern--left{ left: 14px; }
.lantern--right{ right: 14px; transform: scaleX(-1); animation-delay: .6s; }
@keyframes lanternSwing{
  0%,100%{ transform: rotate(-4deg); }
  50%{ transform: rotate(4deg); }
}

.cloud{
  position: fixed;
  bottom: 8vh;
  width: min(520px, 70vw);
  z-index: 7;
  opacity: .35;
  pointer-events:none;
  filter: blur(.2px) drop-shadow(0 8px 16px rgba(0,0,0,.25));
}
.cloud img{ width:100%; height:auto; display:block; }
.cloud--1{ left: -12vw; animation: cloudMove1 26s linear infinite; }
.cloud--2{ right: -14vw; bottom: 18vh; opacity:.28; animation: cloudMove2 32s linear infinite; }
@keyframes cloudMove1{ 0%{ transform: translateX(0); } 100%{ transform: translateX(130vw); } }
@keyframes cloudMove2{ 0%{ transform: translateX(0) scaleX(-1); } 100%{ transform: translateX(-140vw) scaleX(-1); } }

.petals{ position: fixed; inset:0; z-index: 7; pointer-events:none; overflow:hidden; }
.petal{
  position:absolute;
  width: 18px;
  height: 18px;
  background: url('./image/petal.svg') no-repeat center/contain;
  opacity: .9;
  animation: petalFall var(--dur) linear infinite;
  will-change: transform;
  filter: drop-shadow(0 6px 8px rgba(0,0,0,.18));
}
@keyframes petalFall{
  0%{ transform: translate3d(var(--x), -10vh, 0) rotate(0deg); opacity: 0; }
  10%{ opacity: .95; }
  100%{ transform: translate3d(calc(var(--x) + var(--drift)), 110vh, 0) rotate(var(--rot)); opacity: 0; }
}

/* ===== Layout card ===== */
.wrap{position:fixed; inset:0; display:grid; place-items:center; padding:12px; z-index: 10; }
.card{
  width:min(920px, 100%);
  border-radius: var(--radius);
  background: linear-gradient(180deg, var(--card), var(--card2));
  border: 1px solid var(--stroke);
  box-shadow: var(--shadow);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  overflow:hidden;
  position:relative;
  display:flex;
  flex-direction:column;
  max-height: calc(100svh - 24px);
}

.topbar{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding:14px 16px;
  background:
    radial-gradient(420px 180px at 15% 30%, rgba(255,204,77,.35), transparent 60%),
    linear-gradient(90deg, rgba(180,0,24,.78), rgba(255,204,77,.28));
  border-bottom: 1px solid rgba(255, 220, 150, .28);
  flex-wrap:wrap;
}

.badge{
  display:inline-flex; align-items:center; gap:8px;
  font-weight:900; letter-spacing:.2px; font-size:14px;
  padding:8px 12px; border-radius:999px;
  background: rgba(255, 243, 222, .78);
  border: 1px solid rgba(255, 220, 150, .40);
  white-space:nowrap;
}

.actions{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:flex-end;}

.pill{
  display:inline-flex; align-items:center; gap:8px;
  padding: 8px 10px; border-radius:999px;
  background: rgba(255, 243, 222, .66);
  border: 1px solid rgba(255, 220, 150, .34);
  font-size:12px; color: rgba(43,21,0,.78);
  user-select:none; white-space:nowrap;
}

.countdownMini{
  display:inline-flex; align-items:center; gap:6px;
  padding: 8px 10px;
  border-radius: 999px;
  background: rgba(0,0,0,.18);
  border: 1px solid rgba(255,255,255,.16);
  color: rgba(255,255,255,.92);
  font-weight: 900;
  font-size: 12px;
}
.countdownMini .cdm b{ color: var(--gold2); }

.btnMusic{
  padding: 8px 12px;
  border-radius:999px;
  border:0;
  cursor:pointer;
  font-weight:950;
  color:#fff;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow: 0 12px 26px rgba(180,0,24,.22);
  transition: transform .12s ease, filter .12s ease;
  white-space:nowrap;
}
.btnMusic:hover{ transform: translateY(-1px); filter: brightness(1.03); }
.btnMusic:active{ transform: translateY(0px) scale(.99); }

.btnSecondary{
  padding: 8px 12px;
  border-radius:999px;
  border: 1px solid rgba(180,0,24,.22);
  background: rgba(255, 243, 222, .78);
  color: rgba(43,21,0,.88);
  font-weight: 900;
  cursor:pointer;
}
.ownerBtn{ padding: 8px 10px; border-radius: 999px; font-size: 12px; line-height:1; }

.musicSelect{
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.20);
  background: rgba(0,0,0,.18);
  color: rgba(255,255,255,.92);
  font-weight: 800;
  font-size: 12px;
  outline:none;
  max-width: 220px;
}

.content{
  display:grid;
  grid-template-columns: 1fr;
  gap:14px;
  padding:14px;
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  flex:1 1 auto;
}
@media (min-width: 780px){
  .content{grid-template-columns: 1.05fr .95fr; align-items:center; gap:18px;}
}

h1{margin:6px 0; line-height:1.05; font-size: clamp(26px, 5vw, 44px);}
.sub{margin: 0 0 14px; color: var(--muted); font-size: clamp(14px, 2.6vw, 16px); line-height: 1.5;}

.wishBox{
  padding:14px; border-radius:18px;
  background: rgba(255, 243, 222, .76);
  border: 1px solid rgba(255, 220, 150, .34);
}
.wish{font-size: clamp(15px, 3.2vw, 18px); line-height: 1.5; margin:0; min-height:56px;}

.row{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}

input, textarea{
  font: inherit;
  color: var(--ink);
}
input{
  flex:1 1 160px; min-width:160px;
  padding:12px 12px; border-radius:14px;
  border: 1px solid rgba(180,0,24,.18);
  background: rgba(255,255,255,.70);
  outline:none;
}
input::placeholder{color: rgba(43,21,0,.48)}
input:disabled{opacity:.6; cursor:not-allowed;}

.btnPrimary, button{
  padding:12px 14px; border-radius:14px; border:0; cursor:pointer;
  font-weight:950; color:#fff;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow: 0 12px 28px rgba(180,0,24,.22);
  transition: transform .12s ease, filter .12s ease;
  white-space:nowrap;
}
.btnPrimary:hover, button:hover{ transform: translateY(-1px); filter: brightness(1.03); }
.btnPrimary:active, button:active{ transform: translateY(0px) scale(.99); }
button:disabled{opacity:.55; cursor:not-allowed; transform:none; filter:none;}

.btnGhost{
  padding:12px 14px;
  border-radius:14px;
  border: 1px solid rgba(180,0,24,.22);
  background: rgba(255,255,255,.55);
  color: rgba(43,21,0,.86);
  font-weight: 950;
}

.btnDanger{
  background: linear-gradient(90deg, var(--danger), #ff9a7a);
}

.side{display:flex; align-items:center; justify-content:center; padding:6px 0 0;}
.bubble{
  width: min(340px, 82vw);
  aspect-ratio: 1/1;
  border-radius:24px;
  background: radial-gradient(220px 220px at 30% 30%, rgba(255,204,77,.18), rgba(255,243,222,.35));
  border: 1px solid rgba(255, 220, 150, .30);
  display:grid; place-items:center;
  position:relative; overflow:hidden;
}
.blob{
  position:absolute; inset:-40%;
  background:
    radial-gradient(circle at 30% 35%, rgba(255,204,77,.20), transparent 40%),
    radial-gradient(circle at 70% 60%, rgba(180,0,24,.18), transparent 40%),
    radial-gradient(circle at 60% 20%, rgba(255,231,153,.16), transparent 45%);
  filter: blur(14px);
  animation: floaty 5s ease-in-out infinite;
}
@keyframes floaty{0%,100%{transform:translate(-2%,-1%) rotate(-2deg)} 50%{transform:translate(2%,1%) rotate(2deg)}}
.avatarImg{
  position: relative;
  width: 78%; height: 78%;
  border-radius: 999px;
  object-fit: cover;
  border: 1px solid rgba(255, 220, 150, .24);
  box-shadow: 0 10px 25px rgba(0,0,0,.18);
  background: rgba(255,255,255,.75);
}

.foot{
  padding: 0 18px 16px;
  color: rgba(255,255,255,.85);
  text-shadow: 0 2px 10px rgba(0,0,0,.35);
  font-size: 12px;
  display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap;
}
.toggle{display:inline-flex; align-items:center; gap:8px; user-select:none; white-space:nowrap;}
.toggle input{ width: 18px; height: 18px; }

.year{
  font-weight: 950;
  background: linear-gradient(90deg, var(--gold), #fff2c7);
  -webkit-background-clip: text;
  background-clip:text;
  color: transparent;
  text-shadow: 0 10px 25px rgba(255, 204, 77, .12);
}

/* ===== Lock overlay ===== */
.lock{
  position: fixed;
  inset: 0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:18px;
  background: rgba(43,0,8,.72);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: 13000;
}
.lockPanel{
  width: min(680px, 96vw);
  border-radius: 20px;
  background: rgba(255, 243, 222, .95);
  border: 1px solid rgba(255, 220, 150, .42);
  box-shadow: 0 22px 70px rgba(0,0,0,.35);
  padding: 16px;
  max-height: calc(100svh - 56px);
  overflow:auto;
}
.lockTitle{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:8px;}
.lockTitle h2{margin:0;font-size:18px;letter-spacing:.2px;line-height:1.2;word-break: break-word;}
.chip{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 10px;border-radius:999px;
  border:1px solid rgba(180,0,24,.22);
  background: rgba(255,255,255,.65);
  font-size:12px;color: rgba(43,21,0,.78);
  white-space:nowrap;
}

.lockCountdown{
  display:flex; align-items:center; gap:8px; flex-wrap:wrap;
  padding:10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255, 220, 150, .42);
  background: rgba(180,0,24,.06);
  margin: 10px 0 12px;
}
.lcdLabel{ font-weight: 900; }
.lcdNum{ font-weight: 900; color: rgba(43,21,0,.85); }
.lcdNum b{ color: var(--accent); }

.mini{font-size:13px;color: rgba(43,21,0,.72);line-height:1.45;margin:0 0 10px;}
.status{
  margin-top:10px;
  padding:10px 12px; border-radius:14px;
  border: 1px solid rgba(255, 220, 150, .42);
  background: rgba(255,255,255,.70);
  font-size: 13px; color: rgba(43,21,0,.88);
  min-height: 42px; display:flex; align-items:center; gap:10px;
}
.status.bad{
  border-color: rgba(255,77,109,.35);
  background: rgba(255,77,109,.08);
  color: rgba(155, 20, 55, .95);
}

.row2{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;}

.selectWrap{position:relative; flex: 1 1 280px; min-width:260px;}
.selectBtn{
  width:100%;
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  padding:12px 12px;
  border-radius:14px;
  border: 1px solid rgba(180,0,24,.18);
  background: rgba(255,255,255,.70);
  color: var(--ink);
  cursor:pointer;
  font-weight:800;
}
.selectBtn small{font-weight:600; color: rgba(43,21,0,.55)}
.menu{
  position:absolute;
  top: calc(100% + 8px);
  left:0; right:0;
  border-radius: 16px;
  background: rgba(255,255,255,.92);
  border: 1px solid rgba(180,0,24,.18);
  box-shadow: 0 18px 40px rgba(0,0,0,.18);
  overflow:hidden;
  z-index: 50;
}
.menuHead{padding:10px;border-bottom:1px solid rgba(180,0,24,.12);background: rgba(255,243,222,.85)}
.menuList{max-height: 260px; overflow:auto;}
.item{padding:10px 12px;display:flex;align-items:center;justify-content:space-between;gap:10px;cursor:pointer;}
.item:hover{ background: rgba(255,204,77,.18); }
.item .left{display:flex;flex-direction:column;gap:2px;}
.item .name{font-weight:900;}
.item .meta{font-size:12px;color: rgba(43,21,0,.62);}
.item .tag{font-size:11px;font-weight:900;padding:6px 8px;border-radius:999px;border:1px solid rgba(180,0,24,.14);background: rgba(255,243,222,.85);color: rgba(43,21,0,.78);white-space:nowrap;}

.hidden{display:none !important;}

/* Wish send */
.wishSend{margin-top:14px;padding:12px;border:1px solid rgba(255, 220, 150, .32);border-radius:16px;background:rgba(255,255,255,.55)}
.wishSendHead{font-weight:900;margin-bottom:8px}
.wishSend textarea{width:100%;resize:vertical;min-height:88px;border-radius:14px;border:1px solid rgba(180,0,24,.18);padding:10px 12px;font:inherit;outline:none;background: rgba(255,255,255,.70)}
.wishSend textarea:focus{border-color:rgba(255,204,77,.65);box-shadow:0 0 0 4px rgba(255,204,77,.18)}
.muted{opacity:.75}

/* Owner modal */
.modal{position:fixed;inset:0;background:rgba(43,0,8,.58);display:flex;align-items:center;justify-content:center;padding:16px;z-index:9999}
.modalCard{width:min(980px,100%);max-height:82vh;overflow:auto;background:rgba(255,243,222,.98);border-radius:20px;padding:14px;box-shadow:0 22px 60px rgba(0,0,0,.35);border:1px solid rgba(255, 220, 150, .32)}
.modalHead{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:10px}
.modalTitle{font-weight:950;font-size:16px}
.modalBtns{display:flex;flex-wrap:wrap;gap:8px;justify-content:flex-end}
.modalBody{font-size:14px;line-height:1.45}
.ownerRow{border:1px solid rgba(255, 220, 150, .32);border-radius:16px;padding:10px 12px;margin:10px 0;background: rgba(255,255,255,.60)}
.ownerMeta{opacity:.78;font-size:12px;margin-bottom:6px}
.pillMini{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(255,204,77,.20);border:1px solid rgba(255,204,77,.40);font-size:12px}

/* Tap audio overlay */
.tapAudio{position:fixed;inset:0;display:grid;place-items:center;background:rgba(43,0,8,.58);backdrop-filter: blur(10px);-webkit-backdrop-filter: blur(10px);z-index: 999; padding: 18px;}
.tapCard{width: min(420px, 92vw);border-radius: 20px;background: rgba(255,243,222,.92);border: 1px solid rgba(255, 220, 150, .42);box-shadow: 0 18px 50px rgba(0,0,0,.35);padding: 16px;text-align:center;}
.tapTitle{font-weight:950;font-size:18px;margin-bottom:6px;}
.tapSub{font-size:13px;color: rgba(43,21,0,.72);line-height:1.45;margin-bottom:12px;}
.tapBtn{display:inline-block;padding:10px 14px;border-radius:999px;color:#fff;font-weight:950;background: linear-gradient(90deg, var(--accent), var(--accent2));box-shadow: 0 10px 25px rgba(180,0,24,.22);}

/* Success overlay */
.successPage{position:fixed; inset:0; display:grid; place-items:center; padding:18px; background: rgba(43,0,8,.58); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); z-index: 99999;}
.successCard{width:min(520px, 92vw); border-radius: 22px; background: rgba(255,243,222,.92); border: 1px solid rgba(255, 220, 150, .42); box-shadow: 0 18px 55px rgba(0,0,0,.35); padding: 18px 16px; text-align:center;}
.successTick{width: 92px; height: 92px; border-radius: 999px; margin: 4px auto 12px; display:grid; place-items:center; background: linear-gradient(135deg, rgba(255,204,77,.35), rgba(180,0,24,.18)); border: 1px solid rgba(255, 220, 150, .34); box-shadow: 0 14px 30px rgba(180,0,24,.18);}
.successTick span{ font-size: 52px; line-height: 1; }
.successTitle{ font-weight: 950; font-size: 18px; margin: 0 0 8px; }
.successText{ font-size: 14px; line-height: 1.55; color: rgba(43,21,0,.78); margin: 0 0 14px; white-space: pre-wrap; }

/* ===== FLOW overlay ===== */
.flow{
  position: fixed;
  inset: 0;
  z-index: 12000;
  display: grid;
  place-items: center;
  padding: 18px;
  background:
    radial-gradient(900px 700px at 50% 35%, rgba(255,204,77,.20), transparent 60%),
    linear-gradient(180deg, rgba(43,0,8,.82), rgba(43,0,8,.35));
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.flowCard{
  width: min(720px, 96vw);
  border-radius: 24px;
  background: rgba(255,243,222,.94);
  border: 1px solid rgba(255, 220, 150, .44);
  box-shadow: 0 26px 80px rgba(0,0,0,.38);
  padding: 16px;
  position: relative;
  overflow: hidden;
}
.flowCard::before{
  content:"";
  position:absolute; inset:-60% -40%;
  background:
    radial-gradient(circle at 30% 30%, rgba(255,204,77,.35), transparent 40%),
    radial-gradient(circle at 70% 65%, rgba(180,0,24,.18), transparent 45%);
  filter: blur(16px);
  animation: cdFloat 6s ease-in-out infinite;
}
@keyframes cdFloat{0%,100%{transform:translate(-2%,-1%) rotate(-2deg)} 50%{transform:translate(2%,1%) rotate(2deg)}}

.flowCard > *{ position: relative; z-index: 2; }


.stage{ text-align:center; }
.stageHero{ display:flex; justify-content:center; margin: 6px 0 10px; }
.horseLogo{ width: min(360px, 78vw); height:auto; display:block; animation: horsePulse 2.6s ease-in-out infinite; }
@keyframes horsePulse{ 0%,100%{ transform: translateY(0) scale(1); } 50%{ transform: translateY(-6px) scale(1.02);} }

.stageTitle{ margin: 6px 0 6px; font-size: 22px; font-weight: 950; }
.stageSub{ margin: 0 0 12px; color: rgba(43,21,0,.72); }
.stageHint{ margin: 12px 0 0; font-size: 12px; color: rgba(43,21,0,.64); }

.countdown{
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin: 10px 0 14px;
}
.cdCell{
  background: rgba(255,255,255,.65);
  border: 1px solid rgba(255, 220, 150, .44);
  border-radius: 16px;
  padding: 10px 8px;
}
.cdCell span{ display:block; font-weight: 980; font-size: 24px; color: rgba(180,0,24,.92); }
.cdCell small{ display:block; margin-top: 4px; color: rgba(43,21,0,.70); font-weight: 800; font-size: 12px; }

.formGrid{ display:grid; grid-template-columns: 1fr; gap: 10px; margin: 10px 0; }
@media (min-width: 640px){ .formGrid{ grid-template-columns: 1fr 1fr; } }
.field{ display:block; text-align:left; }
.field span{ display:block; font-weight: 900; margin: 0 0 6px; color: rgba(43,21,0,.82); }

.rowActions{ display:flex; gap: 10px; justify-content:center; flex-wrap:wrap; margin-top: 10px; }

.noteBox{
  margin-top: 12px;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px dashed rgba(180,0,24,.28);
  background: rgba(180,0,24,.05);
  color: rgba(43,21,0,.78);
}

/* Wheel */
.wheelWrap{ position: relative; width: min(380px, 82vw); margin: 12px auto; aspect-ratio: 1/1; }
.wheel{
  position:absolute; inset: 0;
  border-radius: 999px;
  border: 10px solid rgba(255, 220, 150, .55);
  box-shadow: 0 18px 55px rgba(0,0,0,.28);
  transform: rotate(0deg);
  transition: transform 4.2s cubic-bezier(.17,.67,.12,1);
  overflow:hidden;
  background: conic-gradient(from -22.5deg, var(--accent) 0 45deg, rgba(255,204,77,.95) 45deg 90deg, var(--accent) 90deg 135deg, rgba(255,204,77,.95) 135deg 180deg, var(--accent) 180deg 225deg, rgba(255,204,77,.95) 225deg 270deg, var(--accent) 270deg 315deg, rgba(255,204,77,.95) 315deg 360deg);
}

.wheelSeg{ position:absolute; inset:0; display:block; transform: rotate(var(--rot)); }
.wheelSeg span{
  position:absolute;
  top: 10%;
  left: 50%;
  transform: translateX(-50%) rotate(var(--neg));
  transform-origin: 50% 0;
  width: 60%;
  font-weight: 950;
  font-size: 12px;
  color: rgba(255,255,255,.95);
  text-shadow: 0 2px 10px rgba(0,0,0,.35);
}
.wheelSeg.isGold span{ color: rgba(43,21,0,.92); text-shadow: 0 2px 10px rgba(255,255,255,.25); }

.wheelPointer{
  position:absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 0; height: 0;
  border-left: 14px solid transparent;
  border-right: 14px solid transparent;
  border-bottom: 26px solid rgba(255, 204, 77, .98);
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.25));
  z-index: 3;
}
.wheelCenter{
  position:absolute;
  inset: 36% 36%;
  border-radius: 999px;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,243,222,.72));
  border: 1px solid rgba(180,0,24,.18);
  box-shadow: 0 10px 22px rgba(0,0,0,.18);
  display:grid;
  place-items:center;
  font-weight: 980;
  color: rgba(180,0,24,.92);
  z-index: 2;
}

.resultBox{
  margin: 12px auto 8px;
  width: min(520px, 92vw);
  padding: 12px 14px;
  border-radius: 16px;
  border: 1px solid rgba(255, 220, 150, .44);
  background: rgba(255,255,255,.65);
  color: rgba(43,21,0,.84);
  text-align:left;
  white-space: pre-wrap;
}

/* Fortune */
.fortuneWrap{ display:grid; gap: 12px; align-items:center; justify-items:center; margin: 10px 0 0; }
.envelope{ width: 150px; height: 120px; position: relative; }
.envelopeBody{
  position:absolute; inset: 18px 0 0;
  border-radius: 16px;
  background: linear-gradient(180deg, rgba(180,0,24,.92), rgba(122,0,20,.95));
  border: 1px solid rgba(255, 220, 150, .35);
  box-shadow: 0 12px 24px rgba(0,0,0,.24);
}
.envelopeTop{
  position:absolute; inset: 0;
  height: 70px;
  background: linear-gradient(180deg, rgba(255,204,77,.95), rgba(255,231,153,.85));
  clip-path: polygon(0 0, 100% 0, 50% 90%);
  filter: drop-shadow(0 8px 12px rgba(0,0,0,.18));
}
.envelopeSeal{
  position:absolute;
  left: 50%;
  top: 54px;
  transform: translateX(-50%);
  width: 42px; height: 42px;
  border-radius: 999px;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,204,77,.85));
  border: 1px solid rgba(180,0,24,.20);
  display:grid; place-items:center;
  font-weight: 980;
  color: rgba(180,0,24,.92);
}
.envelope.shake{ animation: shake 0.8s ease-in-out; }
@keyframes shake{
  0%{ transform: rotate(0deg); }
  15%{ transform: rotate(-6deg); }
  30%{ transform: rotate(6deg); }
  45%{ transform: rotate(-5deg); }
  60%{ transform: rotate(5deg); }
  75%{ transform: rotate(-3deg); }
  100%{ transform: rotate(0deg); }
}

.fortuneCard{
  width: min(520px, 92vw);
  border-radius: 18px;
  padding: 12px 14px;
  background: rgba(255,255,255,.65);
  border: 1px solid rgba(255, 220, 150, .44);
  text-align:left;
}
.fortuneMoney{ font-weight: 980; font-size: 24px; color: rgba(180,0,24,.92); }
.fortuneMsg{ margin-top: 6px; font-size: 14px; line-height: 1.45; color: rgba(43,21,0,.84); white-space: pre-wrap; }
.fortuneMeta{ margin-top: 8px; font-size: 12px; color: rgba(43,21,0,.62); }

/* Mobile tweaks */
@media (max-width: 520px){
  .wrap{padding:0; place-items:stretch;}
  .card{width:100%; max-height:100svh; border-radius:0;}
  .topbar{padding:10px 12px;}
  .badge{font-size:12px}
  .pill{display:none}
  .side{order:-1; padding:4px 0 0;}
  .bubble{width: min(240px, 70vw); border-radius:20px;}
  .avatarImg{width:84%; height:84%;}

  .actions{
    display:grid;
    grid-template-columns: 1fr auto auto auto;
    gap:8px;
    align-items:center;
    width:100%;
  }
  .musicSelect{ width:100%; min-width:0; max-width:none; height:36px; font-size:13px; padding:8px 10px; }
  .btnMusic{ width:36px; height:36px; padding:0; border-radius:12px; display:inline-flex; align-items:center; justify-content:center; font-size:16px; }
  .btnMusic .txt{display:none;}
  .ownerBtn{grid-column: 1 / -1; height:36px;}

  .row input, .row button, #btnWish{width:100%; flex: 1 1 100%;}
  textarea#wishMsg{min-height:96px}

  .row2 > *{width:100%; flex: 1 1 100%;}
  .selectWrap{min-width:0;}

  .countdown{ grid-template-columns: repeat(2, 1fr); }
}

/* iOS safe area */
@supports (padding: max(0px)) {
  .wrap{
    padding: max(0px, env(safe-area-inset-top))
             max(0px, env(safe-area-inset-right))
             max(0px, env(safe-area-inset-bottom))
             max(0px, env(safe-area-inset-left));
  }
  @media (max-width: 520px){
    .wrap{padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom) 0;}
  }
}

/* Hint unlock game */
.gameLockHintTop{
  margin: 10px 16px 0;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255, 220, 150, .38);
  background: rgba(180, 0, 24, .10);
  color: rgba(43,21,0,.88);
  font-size: 13px;
  box-shadow: 0 10px 24px rgba(180,0,24,.14);
}
