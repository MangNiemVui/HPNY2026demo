<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Thiแปp Nฤm Mแปi 2026 โข Nฤm Ngแป ๐ด</title>

  <link rel="stylesheet" href="./styles.css?v=20260216" />
</head>

<body>
  <!-- Fireworks / FX -->
  <canvas id="fx" aria-hidden="true"></canvas>
  <div class="sparkles" aria-hidden="true"></div>

  <!-- Decorative layer (CSS animation, not GIF) -->
  <div class="lantern lantern--left" aria-hidden="true">
    <img src="./image/lantern.svg" alt="" />
  </div>
  <div class="lantern lantern--right" aria-hidden="true">
    <img src="./image/lantern.svg" alt="" />
  </div>
  <div class="cloud cloud--1" aria-hidden="true"><img src="./image/cloud.svg" alt="" /></div>
  <div class="cloud cloud--2" aria-hidden="true"><img src="./image/cloud.svg" alt="" /></div>
  <div class="petals" id="petals" aria-hidden="true"></div>

  <div class="wrap">
    <div class="card">

      <!-- ===== Post-login flow overlay ===== -->
      <div class="flow hidden" id="flow" role="dialog" aria-modal="true" aria-label="Trรฒ chฦกi ฤแบงu nฤm">
        <div class="flowCard">
          <!-- Stage: Intro -->
          <section class="stage" id="stageIntro">
            <div class="stageHero">
              <img class="horseLogo" src="./image/horse-2026.svg" alt="Nฤm Ngแป 2026" />
            </div>
            <h2 class="stageTitle">Chรบc Mแปซng Nฤm Mแปi 2026</h2>
            <p class="stageSub">ฤแบฟm ngฦฐแปฃc ฤแบฟn khoแบฃnh khแบฏc giao thแปซa (Tแบฟt 2026)</p>

            <div class="countdown" aria-label="Bแป ฤแบฟm giแป">
              <div class="cdCell"><span id="cdDays">0</span><small>Ngรy</small></div>
              <div class="cdCell"><span id="cdHours">00</span><small>Giแป</small></div>
              <div class="cdCell"><span id="cdMinutes">00</span><small>Phรบt</small></div>
              <div class="cdCell"><span id="cdSeconds">00</span><small>Giรขy</small></div>
            </div>

            <button class="btnPrimary" id="btnIntroStart" type="button">Bแบฏt ฤแบงu nhแบญn lแปc โจ</button>
          </section>

          <!-- Stage: Bank info -->
          <section class="stage hidden" id="stageBank">
            <h2 class="stageTitle">Nhแบญp thรดng tin nhแบญn lแปc</h2>
            <p class="stageSub">Vui lรฒng nhแบญp ฤรบng thรดng tin ฤแป nhแบญn lแปc ฤแบงu nฤm nhรฉ ๐งง</p>

            <div class="formGrid">
              <label class="field">
                <span>Tรชn ngรขn hรng</span>
                <input id="bankName" type="text" placeholder="VD: Vietcombank" autocomplete="off" />
              </label>
              <label class="field">
                <span>Sแป tรi khoแบฃn</span>
                <input id="bankAccount" type="text" inputmode="numeric" placeholder="VD: 0123456789" autocomplete="off" />
              </label>
            </div>

            <div class="rowActions">
              <button class="btnPrimary" id="btnBankConfirm" type="button">Xรกc nhแบญn</button>
              <button class="btnGhost" id="btnBankBack" type="button">Quay lแบกi</button>
            </div>

            <div class="noteBox" id="bankNote">Sau khi xรกc nhแบญn bแบกn sแบฝ ฤฦฐแปฃc chฦกi vรฒng quay may mแบฏn ๐ก</div>
          </section>

          <!-- Stage: Wheel -->
          <section class="stage hidden" id="stageWheel">
            <h2 class="stageTitle">Vรฒng quay may mแบฏn</h2>
            <p class="stageSub">Chแป cรณ 2 phแบงn quร: <b>Vรฒng tay Pandora</b> & <b>Nhแบซn Pandora</b> ๐</p>

            <div class="wheelWrap">
              <div class="wheelPointer" aria-hidden="true"></div>
              <div class="wheel" id="wheel" aria-label="Vรฒng quay"></div>
              <div class="wheelCenter" aria-hidden="true">LแปC</div>
            </div>

            <div class="rowActions">
              <button class="btnPrimary" id="btnSpin" type="button">Quay ngay</button>
              <button class="btnGhost" id="btnWheelBack" type="button">Quay lแบกi</button>
            </div>

            <div class="resultBox hidden" id="wheelResult"></div>
            <button class="btnPrimary hidden" id="btnWheelNext" type="button">Tiแบฟp tแปฅc</button>
          </section>

          <!-- Stage: Fortune -->
          <section class="stage hidden" id="stageFortune">
            <h2 class="stageTitle">Lแบฏc quแบป may mแบฏn</h2>
            <p class="stageSub">Lแบฏc mแปt cรกi lร cรณ lแปc liแปn tay ๐งง</p>

            <div class="fortuneWrap">
              <div class="envelope" id="envelope" aria-hidden="true">
                <div class="envelopeTop"></div>
                <div class="envelopeBody"></div>
                <div class="envelopeSeal">็ฆ</div>
              </div>

              <div class="fortuneCard" id="fortuneCard">
                <div class="fortuneMoney" id="fortuneMoney">โ</div>
                <div class="fortuneMsg" id="fortuneMsg">Bแบฅm โLแบฏc quแบปโ ฤแป nhแบญn lแปi chรบc.</div>
                <div class="fortuneMeta" id="fortuneMeta"></div>
              </div>
            </div>

            <div class="rowActions">
              <button class="btnPrimary" id="btnShake" type="button">Lแบฏc quแบป</button>
              <button class="btnGhost" id="btnFortuneBack" type="button">Quay lแบกi</button>
            </div>

            <button class="btnPrimary hidden" id="btnFinish" type="button">Vรo xem thiแปp โจ</button>
          </section>
        </div>
      </div>
      <!-- ===== End flow overlay ===== -->

      <!-- ===== Lock overlay (login) ===== -->
      <div class="lock" id="lock">
        <div class="lockPanel">
          <div class="lockTitle">
            <h2>๐ Mแป thiแปp bแบฑng TรN + MแบฌT KHแบจU</h2>
            <span class="chip" id="chip">Chฦฐa mแป</span>
          </div>

          <div class="lockCountdown" aria-label="ฤแบฟm ngฦฐแปฃc">
            <span class="lcdLabel">ฤแบฟm ngฦฐแปฃc Tแบฟt 2026:</span>
            <span class="lcdNum"><b id="cdMiniDays">0</b>d</span>
            <span class="lcdNum"><b id="cdMiniHours">00</b>:</span>
            <span class="lcdNum"><b id="cdMiniMinutes">00</b>:</span>
            <span class="lcdNum"><b id="cdMiniSeconds">00</b></span>
          </div>

          <p class="mini">
            Chแปn ngฦฐแปi cแบงn xem, nhแบญp mแบญt khแบฉu rแปi bแบฅm <b>Mแป thiแปp</b>.
            Nแบฟu bแบกn ฤฤng nhแบญp <b>Owner</b>, bแบกn cรณ thแป xem thiแปp cแปงa ngฦฐแปi khรกc mร khรดng cแบงn mแบญt khแบฉu cแปงa hแป.
          </p>

          <div class="row2">
            <div class="selectWrap" id="selectWrap">
              <button class="selectBtn" id="selectBtn" type="button">
                <span id="selectText"><small>Chแปn ngฦฐแปiโฆ</small></span>
                <span>โพ</span>
              </button>
              <div class="menu hidden" id="menu">
                <div class="menuHead">
                  <input id="search" placeholder="Tรฌm tรชn hoแบทc keyโฆ" />
                </div>
                <div class="menuList" id="menuList"></div>
              </div>
            </div>

            <input id="pass" type="password" placeholder="Mแบญt khแบฉu" />
          </div>

          <div class="row2">
            <button id="btnUnlock" class="btnPrimary" type="button">Mแป thiแปp โจ</button>
            <button class="btnSecondary" id="btnOwnerView" type="button" disabled>Xem thiแปp ngฦฐแปi nรy (Owner)</button>
            <!-- NEW: Owner cho chฦกi lแบกi (local) -->
            <button class="btnSecondary" id="btnOwnerReplay" type="button" disabled>Cho chฦกi lแบกi ๐ก</button>
            <button class="btnSecondary" id="btnHint" type="button">Tip mแบญt khแบฉu</button>
          </div>

          <div class="row2">
            <button class="btnDanger hidden" id="btnLogout" type="button">ฤฤng xuแบฅt</button>
          </div>

          <div class="status" id="status">๐ Chแปn ngฦฐแปi + nhแบญp mแบญt khแบฉu ฤแป bแบฏt ฤแบงu.</div>
        </div>
      </div>

      <!-- ===== Topbar ===== -->
      <div class="topbar">
        <div class="badge" id="badge">๐ด Thiแปp Nฤm Mแปi โข Nฤm Ngแป 2026 ๐</div>

        <div class="actions">
          <span class="pill">Chแบกm / click ฤแป bแบฏn phรกo hoa ๐</span>

          <div class="countdownMini" title="ฤแบฟm ngฦฐแปฃc tแปi Tแบฟt 2026">
            <span class="cdm"><b id="cdMiniDays2">0</b>d</span>
            <span class="cdm"><b id="cdMiniHours2">00</b>:</span>
            <span class="cdm"><b id="cdMiniMinutes2">00</b>:</span>
            <span class="cdm"><b id="cdMiniSeconds2">00</b></span>
          </div>

          <!-- NEW: nรบt Nhแบญn lแปc (bแป khรณa cho tแปi khi gแปญi lแปi chรบc) -->
          <button class="btnSecondary" id="btnOpenLuck" type="button" disabled>๐ Nhแบญn lแปc</button>

          <select id="musicSelect" class="musicSelect" aria-label="Chแปn nhแบกc"></select>
          <button class="btnMusic" id="btnPrev" title="Bรi trฦฐแปc">โฎ</button>
          <button class="btnMusic" id="btnMusic" aria-label="Bแบญt/Tแบฏt nhแบกc">
            <span class="ico" aria-hidden="true">โถ๏ธ</span><span class="txt">Phรกt nhแบกc</span>
          </button>
          <button class="btnMusic" id="btnNext" title="Bรi tiแบฟp">โญ</button>

          <button class="btnSecondary hidden ownerBtn" id="btnOwnerLogin" type="button">๐ Owner Login</button>
          <button class="btnSecondary hidden ownerBtn" id="btnOwnerLogout" type="button">๐ Owner Logout</button>
          <button class="btnSecondary hidden ownerBtn" id="btnOwnerDashboard" type="button">๐ Dashboard</button>
        </div>
      </div>

      <!-- NEW: hint khรณa game -->
      <div id="gameLockHintTop" class="gameLockHintTop" style="display:none">
        ๐ Bแบกn hรฃy <b>Gแปญi lแปi chรบc</b> cho chแปง sแป hแปฏu trฦฐแปc ฤแป mแป khรณa โNhแบญn lแปcโ.
      </div>

      <!-- ===== Main content ===== -->
      <div class="content">
        <div>
          <h1>Chรบc Mแปซng Nฤm Mแปi <span class="year" id="yearText">2026</span></h1>
          <p class="sub" id="subLine">Mแป khรณa xong bแบกn sแบฝ thแบฅy lแปi chรบc dรnh riรชng cho bแบกn ๐</p>

          <div class="wishBox">
            <p class="wish" id="wish">๐ Thiแปp ฤang khรณa. Hรฃy mแป thiแปp ฤแป xem lแปi chรบc.</p>

            <div class="row">
              <input id="viewerName" placeholder="Tรชn (tแปฑ ฤiแปn sau khi mแป)" disabled />
              <input id="yearInput" maxlength="6" inputmode="numeric" placeholder="Nฤm (vd: 2026)" />
              <button id="btnWish" disabled type="button">ฤแปi lแปi chรบc</button>
            </div>

            <div class="wishSend">
              <div class="wishSendHead">๐ Bแบกn cรณ muแปn gแปญi lแปi chรบc ฤแบฟn chแปง sแป hแปฏu khรดng?</div>
              <textarea id="wishMsg" rows="3" placeholder="Bแบกn hรฃy nhแบญp vรo ฤรขy gแปญi lแปi chรบc ฤแบฟn chแปง sแป hแปฏu nhรฉ..."></textarea>
              <div class="row">
                <button class="btnSecondary" id="btnSendWish" type="button" disabled>Gแปญi lแปi chรบc</button>
                <small class="muted" id="wishSendHint">* Bแบฅm โGแปญiโ ฤแป lฦฐu Firestore + gแปญi EmailJS (nแบฟu ฤรฃ cแบฅu hรฌnh).</small>
              </div>
            </div>
          </div>
        </div>

        <div class="side">
          <div class="bubble">
            <div class="blob" aria-hidden="true"></div>
            <img id="avatarImg" class="avatarImg" src="./avatars/default.pnj.jpg" alt="แบขnh ngฦฐแปi nhแบญn" />
          </div>
        </div>
      </div>

      <div class="foot">
        <label class="toggle">
          <input type="checkbox" id="auto" checked />
          Tแปฑ ฤแปng bแบฏn phรกo hoa
        </label>
        <span>Tip: Bแบฅm icon play mแป nhแบกc rแปi cรณ thแป chแปn nhแบกc theo danh sรกch ฤรณ muแปn nghe bรi nรo cลฉng ฤฦฐแปฃc nhรณ. โจ</span>
      </div>
    </div>
  </div>

  <!-- Owner Dashboard Modal -->
  <div id="ownerModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Owner Dashboard">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">๐ Owner Dashboard</div>
        <div class="modalBtns">
          <button class="btnSecondary" id="btnTabViews" type="button">Lฦฐแปฃt xem</button>
          <button class="btnSecondary" id="btnTabWishes" type="button">Lแปi chรบc</button>
          <button class="btnSecondary" id="btnRefreshOwner" type="button">Lรm mแปi</button>
          <button class="btnPrimary" id="btnCloseOwner" type="button">ฤรณng</button>
        </div>
      </div>
      <div id="ownerBody" class="modalBody">ฤang tแบฃi...</div>
    </div>
  </div>

  <!-- Tap audio overlay -->
  <div id="tapAudio" class="tapAudio hidden" role="button" aria-label="Chแบกm ฤแป bแบญt nhแบกc">
    <div class="tapCard">
      <div class="tapTitle">๐ Chแบกm ฤแป bแบญt nhแบกc</div>
      <div class="tapSub">iPhone cแบงn thao tรกc 1 lแบงn ฤแป cho phรฉp phรกt nhแบกc ๐ถ</div>
      <div class="tapBtn">Chแบกm ngay โจ</div>
    </div>
  </div>

  <!-- Success overlay -->
  <div id="successPage" class="successPage hidden" role="dialog" aria-modal="true" aria-label="Gแปญi lแปi chรบc thรnh cรดng">
    <div class="successCard">
      <div class="successTick"><span>โ</span></div>
      <h3 class="successTitle">Gแปญi lแปi chรบc thรnh cรดng!</h3>
      <p class="successText">
Cแบฃm ฦกn bแบกn nฤm qua ฤรฃ แป bรชn cแบกnh tรดi nhรฉ.
Mong nฤm 2026 chรบng ta vแบซn tiแบฟp tแปฅc ฤแปng hรnh vแปi nhau ๐
      </p>
      <div class="row" style="justify-content:center">
        <button id="btnSuccessLuck" class="btnSecondary" type="button">๐ Nhแบญn lแปc ngay</button>
        <button id="btnSuccessClose" class="btnPrimary" type="button">Quay lแบกi thiแปp</button>
      </div>
    </div>
  </div>

  <audio id="music" preload="metadata" loop playsinline webkit-playsinline></audio>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

  <!-- config + services -->
  <script src="./config.js"></script>
  <script type="module" src="./services.js?v=20260216"></script>
  <script type="module" src="./app.js?v=20260216"></script>
</body>
</html>
